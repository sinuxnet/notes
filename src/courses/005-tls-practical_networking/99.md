[TOC]

# What SSL & TLS Actually Are

* The Internet is a collection of independently operated networks. Data traverses multiple routers and administrative domains before reaching its destination.

* Once data leaves your host, you lose direct control over how it is routed, inspected, or captured.

* HTTP is a **cleartext application-layer protocol**.

  * It provides **no encryption**, **no integrity**, and **no authentication**.
  * Any intermediary can observe or modify HTTP traffic.

* Example HTTP request:

  ```http
  GET /index.html
  Host: site.com
  ```

  This request — and the corresponding HTML response — is transmitted in plaintext and forwarded hop-by-hop across the network.

## What SSL/TLS Do

* SSL/TLS operate **between the application layer and the transport layer**.
* They provide a **cryptographically protected session**, not a physical tunnel.
* HTTPS is **HTTP over TLS**, not a separate protocol.

TLS can protect **any TCP-based application**, including:

- HTTPS
- SMTP (STARTTLS)
- IMAP/POP3
- VPNs (historically SSL VPNs)

* There is no mechanism for encryption in HTTP, and the sample HTML transmission is unencrypted on the network.

## SSL vs TLS 

* **SSL** is deprecated and insecure (SSLv2, SSLv3).
* **TLS** is the modern protocol family (TLS 1.2, TLS 1.3).
* TLS is not “SSL renamed”; it is a **cryptographic evolution** with incompatible wire formats.

# Security Guarantees Provided by TLS

TLS provides **three cryptographic guarantees**:

#### 1. Confidentiality

- **Goal:** Data is only accessible by the client and server
- Achieved using **symmetric encryption** (AES, ChaCha20)
- Prevents passive eavesdropping

#### 2. Integrity

- Achieved using **MACs or AEAD modes**
- Detects message modification
- Does **not prevent** modification, but ensures detection

#### 3. Authentication

- Achieved using **public-key cryptography and X.509 certificates**
- Typically authenticates the server
- Client authentication is optional

# Anti-Replay & Non-Repudiation

## Anti-Replay

**Problem:** If a hacker (man-in-the-middle) captures a valid message and duplicates it, they can maliciously repeat the transaction. Anti-replay mechanisms prevent this.

* Implemented using built-in sequence numbers for each SSL/TLS message
* Allows the receiver to detect duplicate or replayed messages (**replay attacks**)
* Built into the **integrity** and **authentication** mechanisms (explained later)

* TLS uses:

  - Sequence numbers

  - MACs bound to sequence numbers

* Replay attacks are detected because:

  - Duplicate sequence numbers invalidate MAC verification
  - This protection is intrinsic to **record-layer integrity**

## Non-Repudiation

Non-repudiation is not about protecting against a man-in-the-middle attack; it is about protecting against a **dishonest sender**.

### What is Repudiation?

**Dictionary:** To refuse to have anything to do with something.

**Problem:** A client sends multiple messages. One message contains incriminating evidence, and the client later claims they never sent it. Non-repudiation makes this denial impossible.

* The sender cannot later deny sending a message
* No additional mechanism is required
* A byproduct of **integrity** and **authentication**

* TLS **alone does not guarantee non-repudiation**
* Non-repudiation requires:
  - Digital signatures
  - Long-term verifiable evidence
* TLS provides **authentication**, not legal non-repudiation
* Non-repudiation is typically achieved at the **application layer** (e.g., signed documents)

# Key Players

SSL/TLS ecosystem involves three key players

* Client
* Server
* Certificate Authority (CA)

## Client

* Entity initiating the TLS Handshake
* When we say client we don't actually mean the users, we actually mean that's going to be making the TLS request, Typically web browser.  (Phone, Apps, Smart Toaster, IoT devices, etc)
* Optionally authenticated (rare)

## Server

* Entity receiving the TLS Handshake
* TLS receiver like webservers (Apache, IIS, NginX etc, or Loadbalancer and SSL Accelerator(devices which can terminate a TLS handshake))
* Always authenticated

> **Mutual Authentication**: Client and the server provides the certificates to prove their identity to each other.

## Certificate Authority

* Governing entity that issues certificates

* Trusted by client and server

* Provides trust anchors

  * If we trust the CA, we trust what the CA trusts

* Five organizations secure 98% percent of the internet:

  1. IdenTrust (51.9 %)
     * Includes the certificates signed by Let's Encrypt
  2. DigiCert (19.4 %):
     * It owns other CA companies from the past:
       * GeoTrust
       * Verisign
       * Thawte
  3. Sectigo (17.5 %)
     * Formally know as Comodo
  4. GoDaddy (6.9 %)
  5. GlobalSign (2.9 %)

  > More detail:
  >
  > https://w3techs.com/technologies/overview/ssl_certificate

# TLS/SSL Versions

:red_circle:  SSL 1.0  (1994):red_circle:  SSL 2.0 (1995) :red_circle: SSL 3.0 (1996) :large_orange_diamond: TLS 1.0 (1999)  :large_orange_diamond:  TLS 1.1 (2006) :green_heart: TLS 1.2 (2008) :green_heart: TLS 1.3 (2018)

* Many version of SSL/TLS have existed over the years
  * As technologies and attacks have evolved, the protocol has evolved
* Today, the world uses TLS - Transport Layer Security
  * SSL - Secure Sockets Layer
  * Terms *"SSL"* and *"TLS"* are mostly interchangeable



